{"ast":null,"code":"import _regeneratorRuntime from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useContext,useEffect,useState}from'react';import ArticlesItem from'../components/ArticleItem';import Pagination from'../components/Pagination';import{useParams}from'react-router-dom';import{useHttp}from'../hooks/http.hook';import{AuthContext}from'../context/AuthContext';import{Loader}from'../components/Loader';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Articles(){var auth=useContext(AuthContext);var _useHttp=useHttp(),request=_useHttp.request,loading=_useHttp.loading;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),articles=_useState2[0],setArticles=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),currentPage=_useState4[0],setCurrentPage=_useState4[1];var _useState5=useState(15),_useState6=_slicedToArray(_useState5,2),countArticles=_useState6[0],setCountArticles=_useState6[1];var fetchArticles=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fetched;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return request('/api/articles-edit/articles','GET',null);case 3:fetched=_context.sent;setArticles(fetched);_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[request]);useEffect(function(){fetchArticles();},[fetchArticles]);var indexLastArticle=currentPage*countArticles;var indexFirstArticle=indexLastArticle-countArticles;var currentArticles=articles.slice(indexFirstArticle,indexLastArticle);var paginate=function paginate(pageNumber){setCurrentPage(pageNumber);};var paginatePrev=function paginatePrev(pageNumber){if(currentPage!==1){setCurrentPage(pageNumber-1);}};var paginateNext=function paginateNext(pageNumber,lastIndex){if(pageNumber!==lastIndex){setCurrentPage(pageNumber+1);}};if(loading){return/*#__PURE__*/_jsx(Loader,{});}if(articles==false){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439, \\u043F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443\"})})});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[!loading&&currentArticles.map(function(article,index){return/*#__PURE__*/_jsx(ArticlesItem,{pathIMG:\"/images/articles/\".concat(article.img),title:article.title,text:article.markdown,link:\"/articles/\".concat(article._id),id:article._id,linkAdm:\"/admpage/article-update/\".concat(article._id)},index);}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(Pagination,{loading:loading,countState:countArticles,totalState:articles.length,currentPage:currentPage,paginate:paginate,paginateNext:paginateNext,paginatePrev:paginatePrev})})]})})});}export default Articles;","map":{"version":3,"sources":["C:/react projects/reactExpress/client/src/Pages/Articles.js"],"names":["React","useCallback","useContext","useEffect","useState","ArticlesItem","Pagination","useParams","useHttp","AuthContext","Loader","Articles","auth","request","loading","articles","setArticles","currentPage","setCurrentPage","countArticles","setCountArticles","fetchArticles","fetched","indexLastArticle","indexFirstArticle","currentArticles","slice","paginate","pageNumber","paginatePrev","paginateNext","lastIndex","map","article","index","img","title","markdown","_id","length"],"mappings":"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","sourcesContent":["import React , {useCallback, useContext, useEffect, useState} from 'react'\r\nimport ArticlesItem from '../components/ArticleItem'\r\nimport Pagination from '../components/Pagination'\r\nimport {useParams} from 'react-router-dom'\r\nimport {useHttp} from '../hooks/http.hook'\r\nimport {AuthContext} from '../context/AuthContext'\r\nimport {Loader} from '../components/Loader'\r\n\r\n\r\nfunction Articles(){\r\n  const auth = useContext(AuthContext)\r\n  const {request, loading} = useHttp()\r\n  const [articles, setArticles] = useState([])\r\n  const [currentPage,setCurrentPage]  = useState(1)\r\n  const [countArticles,setCountArticles] = useState(15)\r\n  \r\n\r\n\r\n  const fetchArticles = useCallback(async () => {\r\n    try {\r\n      const fetched = await request('/api/articles-edit/articles', 'GET', null)\r\n      setArticles(fetched)\r\n    } catch (e) {}\r\n  }, [request])\r\n  \r\n  useEffect(() => {\r\n    fetchArticles()\r\n  }, [fetchArticles])\r\n \r\n  const indexLastArticle = currentPage * countArticles\r\n  const indexFirstArticle = indexLastArticle - countArticles\r\n  const currentArticles = articles.slice(indexFirstArticle,indexLastArticle)\r\n\r\n  const paginate=(pageNumber)=>{setCurrentPage(pageNumber)}\r\n  const paginatePrev=(pageNumber)=>{\r\n    if (currentPage!==1){\r\n      setCurrentPage(pageNumber-1)\r\n     \r\n    }\r\n \r\n  }\r\n\r\n   \r\n  const paginateNext= (pageNumber,lastIndex) => {\r\n    if (pageNumber!==lastIndex){\r\n      setCurrentPage(pageNumber+1)\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return <Loader/>\r\n  }\r\n\r\n  if(articles==false){\r\n    return(\r\n      <>\r\n      <div className=\"container\">\r\n        <h3>Пока нет новостей, перезагрузите страницу</h3>\r\n      </div>\r\n      </>\r\n    )\r\n  }\r\n    return(\r\n        <>\r\n            <div className=\"container\">\r\n                <div className=\"row\">\r\n                  {!loading && currentArticles.map((article,index)=>{\r\n                    return(\r\n                      <ArticlesItem key={index} pathIMG={`/images/articles/${article.img}`} title={article.title} \r\n                      text={article.markdown} \r\n                      link={`/articles/${article._id}`}\r\n                      id={article._id}\r\n                      linkAdm={`/admpage/article-update/${article._id}`}/>\r\n                    )\r\n                  })}\r\n                       \r\n                        \r\n                  <div className=\"row\">\r\n                  <Pagination \r\n                  loading={loading} \r\n                  countState={countArticles} \r\n                  totalState={articles.length} \r\n                  currentPage={currentPage} \r\n                  paginate={paginate}\r\n                  paginateNext={paginateNext}\r\n                  paginatePrev={paginatePrev}/>\r\n                      \r\n                  </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nexport default Articles"]},"metadata":{},"sourceType":"module"}