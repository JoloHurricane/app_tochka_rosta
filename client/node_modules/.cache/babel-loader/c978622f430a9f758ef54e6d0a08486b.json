{"ast":null,"code":"import _toConsumableArray from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState,useCallback}from\"react\";import{Link}from'react-router-dom';import DocumentCategoryFields from'./DocumentCategoryFields';import{AuthContext}from'../context/AuthContext';import{useHttp}from\"../hooks/http.hook\";import{useMessage}from\"../hooks/message.hook\";import{useParams}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function EventsEdit(){function submitHandler(event){event.preventDefault();}var currentRoute=window.location.pathname;var auth=useContext(AuthContext);var message=useMessage();var _useHttp=useHttp(),loading=_useHttp.loading,error=_useHttp.error,request=_useHttp.request,clearError=_useHttp.clearError;var _useState=useState({title:'',date:'',deteEnd:'',_id:''}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),id=_useState4[0],setId=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),events=_useState6[0],setEvents=_useState6[1];useEffect(function(){window.M.updateTextFields();});useEffect(function(){message(error);clearError();},[error,message,clearError]);var changeHandler=function changeHandler(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var fetchEvents=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fetched;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return request('/api/events-edit/events','GET',null);case 3:fetched=_context.sent;setEvents(fetched);_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[request]);useEffect(function(){fetchEvents();},[fetchEvents]);var deleteHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data,newArr;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return request(\"/api/events-edit/delete/\".concat(e.target.name),'POST',{},{},'application/json');case 3:data=_context2.sent;message(data.message);newArr=events.filter(function(elem){return elem._id!==e.target.name;});setEvents(_toConsumableArray(newArr));_context2.next=11;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function deleteHandler(_x){return _ref2.apply(this,arguments);};}();var createHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return request('/api/events-edit/create','POST',_objectSpread({},form),{},'application/json');case 3:data=_context3.sent;message(data.message);setEvents(function(prevArr){return[{title:form.title,createdAt:data.createdAt,createdEnd:data.createdEnd,_id:data._id}].concat(_toConsumableArray(prevArr));});_context3.next=10;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function createHandler(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"adm-form col s12 m12\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,method:\"post\",enctype:\"multipart/form-data\",style:{paddingTop:\"40px\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col offset-l2 s4\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"title\",name:\"title\",type:\"text\",class:\"\",value:form.title,onChange:changeHandler}),/*#__PURE__*/_jsx(\"label\",{for:\"title\",children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s4 l2\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"date\",name:\"date\",type:\"text\",class:\"\",value:form.date,onChange:changeHandler}),/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"\\u0414\\u0430\\u0442\\u0430 \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-field col s4 l2\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"dateEnd\",name:\"dateEnd\",type:\"text\",class:\"\",value:form.dateEnd,onChange:changeHandler}),/*#__PURE__*/_jsx(\"label\",{for:\"dateEnd\",children:\"\\u0414\\u0430\\u0442\\u0430 \\u043A\\u043E\\u043D\\u0446\\u0430\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:createHandler,type:\"submit\",className:\"btn green waves-effect waves-light\",children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col s12 m12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table col s12 m10 offset-m2 \",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0414\\u0430\\u0442\\u0430 \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0414\\u0430\\u0442\\u0430 \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:!loading&&events.map(function(event,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:event.title}),/*#__PURE__*/_jsx(\"td\",{children:event.createdAt}),/*#__PURE__*/_jsx(\"td\",{children:event.createdEnd}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(Link,{className:\"btn blue waves-effect waves-light btn-small\",to:\"/admpage/eventUpdate/\".concat(event._id),children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(\"button\",{name:event._id,onClick:deleteHandler,type:\"submit\",className:\"btn red waves-effect waves-light btn-small\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]},index);})})]})})})]})});}export default EventsEdit;","map":{"version":3,"sources":["C:/react projects/reactExpress/client/src/components/EventsEdit.js"],"names":["React","useEffect","useContext","useState","useCallback","Link","DocumentCategoryFields","AuthContext","useHttp","useMessage","useParams","EventsEdit","submitHandler","event","preventDefault","currentRoute","window","location","pathname","auth","message","loading","error","request","clearError","title","date","deteEnd","_id","form","setForm","id","setId","events","setEvents","M","updateTextFields","changeHandler","e","target","name","value","fetchEvents","fetched","deleteHandler","data","newArr","filter","elem","createHandler","prevArr","createdAt","createdEnd","paddingTop","dateEnd","map","index"],"mappings":"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","sourcesContent":["import React,{useEffect, useContext,useState,useCallback} from \"react\";\r\nimport {Link} from 'react-router-dom'\r\nimport DocumentCategoryFields from './DocumentCategoryFields'\r\nimport { AuthContext } from '../context/AuthContext'\r\nimport {useHttp} from \"../hooks/http.hook\" \r\nimport {useMessage} from \"../hooks/message.hook\"\r\nimport {useParams} from 'react-router-dom'\r\n\r\nfunction EventsEdit(){\r\n    function submitHandler(event){\r\n        event.preventDefault()\r\n    }\r\n    const currentRoute = window.location.pathname\r\n    const auth = useContext(AuthContext)\r\n    const message = useMessage()\r\n    const {loading,error,request,clearError} = useHttp()\r\n    const [form,setForm] = useState({\r\n      title:'',\r\n      date:'',\r\n      deteEnd:'',\r\n      _id:''\r\n      \r\n    \r\n      \r\n    }) \r\n  \r\n    const [id,setId] = useState('')\r\n\r\n    const [events, setEvents] = useState([])\r\n   \r\n\r\n    useEffect(() => {\r\n      window.M.updateTextFields()\r\n    },)\r\n\r\n        useEffect(()=>{\r\n            message(error)\r\n            clearError()\r\n          },[error,message,clearError])\r\n\r\n          const changeHandler = e=>{\r\n            setForm({...form, [e.target.name]: e.target.value})\r\n          }  \r\n\r\n          const fetchEvents = useCallback(async () => {\r\n            try {\r\n                  const fetched = await request('/api/events-edit/events', 'GET', null)\r\n                  setEvents(fetched)\r\n                  \r\n                 \r\n          } catch (e) {}\r\n        }, [request])\r\n        \r\n        useEffect(() => {\r\n          fetchEvents()\r\n          \r\n        }, [fetchEvents])\r\n\r\n        const deleteHandler = async(e)=>{\r\n          try{\r\n            const data=await request(`/api/events-edit/delete/${e.target.name}`,'POST',{} , \r\n            {},'application/json')\r\n            message(data.message)\r\n           const newArr = events.filter(elem => elem._id !== e.target.name);\r\n            \r\n             setEvents([...newArr])\r\n            \r\n          }catch(e){}\r\n\r\n      }\r\n      \r\n          const createHandler= async ()=>{\r\n            try{\r\n             \r\n              const data=await request('/api/events-edit/create','POST',{...form} , \r\n              {},'application/json')\r\n              message(data.message)\r\n              setEvents(prevArr=>[{title:form.title,createdAt:data.createdAt,createdEnd:data.createdEnd,_id:data._id},...prevArr,])\r\n            \r\n           \r\n              \r\n              \r\n  \r\n            }catch(e){\r\n      \r\n            }\r\n        }\r\n        \r\n       \r\n   \r\n    return(\r\n      \r\n        <>\r\n         <div className=\"row\">\r\n            \r\n            <div className=\"adm-form col s12 m12\">\r\n           \r\n                <form onSubmit={submitHandler} method=\"post\" enctype=\"multipart/form-data\" style={{paddingTop:\"40px\"}}>\r\n                  <div className=\"input-field col offset-l2 s4\">\r\n                   <input id=\"title\" name=\"title\" type=\"text\" class=\"\" \r\n                      value={form.title} onChange={changeHandler}  />\r\n                    <label for=\"title\">Название</label>\r\n                  </div>\r\n                  <div className=\"input-field col s4 l2\">\r\n                    <input id=\"date\" name=\"date\" type=\"text\" class=\"\" \r\n                        value={form.date} onChange={changeHandler} />\r\n                      <label for=\"date\">Дата начала</label>\r\n                    </div> \r\n                  <div className=\"input-field col s4 l2\">\r\n                    <input id=\"dateEnd\" name=\"dateEnd\" type=\"text\" class=\"\" \r\n                          value={form.dateEnd} onChange={changeHandler}   />\r\n                      <label for=\"dateEnd\">Дата конца</label>\r\n                    </div> \r\n                  <div className=\"input-field col s2\">\r\n                  <button onClick={createHandler}  type=\"submit\" className=\"btn green waves-effect waves-light\">Создать</button>\r\n                    </div>    \r\n                </form> \r\n\r\n            </div>\r\n            <div className=\"col s12 m12\">\r\n                <div className=\"table col s12 m10 offset-m2 \">\r\n                <table>\r\n        <thead>\r\n          <tr>\r\n              <th>Название</th>\r\n              <th>Дата начала</th>\r\n              <th>Дата окончания</th>\r\n              <th></th>\r\n              <th></th>\r\n          </tr>\r\n        </thead>\r\n\r\n        <tbody>\r\n        {!loading && events.map((event,index)=>{\r\n                    return(\r\n                      <tr key={index}>\r\n                        <td>{event.title}</td>\r\n                        <td>{event.createdAt}</td>\r\n                        <td>{event.createdEnd}</td>\r\n                        <td> <Link className=\"btn blue waves-effect waves-light btn-small\" to={`/admpage/eventUpdate/${event._id}`}>Обновить</Link></td>\r\n                        <td> <button name={event._id} onClick={deleteHandler} type=\"submit\" className=\"btn red waves-effect waves-light btn-small\">Удалить</button></td>\r\n                      </tr>\r\n                    )\r\n                  })}\r\n         \r\n         \r\n        </tbody>\r\n      </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        </>\r\n    )\r\n\r\n\r\n}\r\n\r\n export default EventsEdit;"]},"metadata":{},"sourceType":"module"}