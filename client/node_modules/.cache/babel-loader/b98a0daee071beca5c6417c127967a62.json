{"ast":null,"code":"import _regeneratorRuntime from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState}from\"react\";import{Link}from'react-router-dom';import GalleryCategoryFormFields from\"./GalleryCategoryFormFields\";import{AuthContext}from'../context/AuthContext';import{useHttp}from\"../hooks/http.hook\";import{useMessage}from\"../hooks/message.hook\";import{Loader}from'../components/Loader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function GalleryCategoryForm(){function submitHandler(event){event.preventDefault();}var currentRoute=window.location.pathname;var auth=useContext(AuthContext);var message=useMessage();var _useHttp=useHttp(),loading=_useHttp.loading,error=_useHttp.error,request=_useHttp.request,clearError=_useHttp.clearError;var _useState=useState({title:'',description:''}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];useEffect(function(){window.M.updateTextFields();});useEffect(function(){message(error);clearError();},[error,message,clearError]);var changeHandler=function changeHandler(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var handleImageChange=function handleImageChange(e){e.preventDefault();var file=e.target.files[0];setFile(file);};var createHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var dataForm,data,imgdata;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dataForm=new FormData();dataForm.append(\"file\",file);_context.next=5;return request('/api/galleryCategory-edit/create','POST',_objectSpread({},form),{},'application/json');case 5:data=_context.sent;message(data.message);_context.next=9;return request('/api/galleryCategory-edit/upload-img','POST',dataForm,{});case 9:imgdata=_context.sent;message(imgdata.message);_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function createHandler(){return _ref.apply(this,arguments);};}();if(loading){return/*#__PURE__*/_jsx(Loader,{});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"adm-form col s12 m12\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,method:\"post\",enctype:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(GalleryCategoryFormFields,{title:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u043D\\u0438\\u0435 \\u0441\\u043E\\u0431\\u044B\\u0442\\u0438\\u044F\",changeHandler:changeHandler,state:form,handleImageChange:handleImageChange,currentRoute:currentRoute}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s3 offset-s3  m2 offset-m4  l1 offset-l4  btn-form\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn green waves-effect waves-light\",onClick:createHandler,disabled:loading,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s4   m1  l1  btn-form\",children:/*#__PURE__*/_jsx(Link,{style:{marginLeft:'60px'},to:\"/admpage/galleryCategory-update\",className:\"btn blue waves-effect waves-light\",children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})})]})]})})})});}export default GalleryCategoryForm;","map":{"version":3,"sources":["C:/react projects/reactExpress/client/src/components/GalleryCategoryFormCreate.js"],"names":["React","useEffect","useContext","useState","Link","GalleryCategoryFormFields","AuthContext","useHttp","useMessage","Loader","GalleryCategoryForm","submitHandler","event","preventDefault","currentRoute","window","location","pathname","auth","message","loading","error","request","clearError","title","description","form","setForm","file","setFile","M","updateTextFields","changeHandler","e","target","name","value","handleImageChange","files","createHandler","dataForm","FormData","append","data","imgdata","marginLeft"],"mappings":"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","sourcesContent":["import React,{useEffect, useContext,useState} from \"react\";\r\nimport {Link} from 'react-router-dom'\r\nimport GalleryCategoryFormFields from \"./GalleryCategoryFormFields\"\r\nimport { AuthContext } from '../context/AuthContext'\r\nimport {useHttp} from \"../hooks/http.hook\" \r\nimport {useMessage} from \"../hooks/message.hook\"\r\nimport {Loader} from '../components/Loader'\r\n\r\nfunction GalleryCategoryForm(){\r\n    function submitHandler(event){\r\n        event.preventDefault()\r\n    }\r\n    const currentRoute = window.location.pathname\r\n    const auth = useContext(AuthContext)\r\n    const message = useMessage()\r\n    const {loading,error,request,clearError} = useHttp()\r\n    const [form,setForm] = useState({\r\n      title:'',\r\n      description:'',\r\n      \r\n    }) \r\n    const [file,setFile] = useState()\r\n    \r\n    useEffect(() => {\r\n      window.M.updateTextFields()\r\n    },)\r\n      \r\n\r\n        useEffect(()=>{\r\n            message(error)\r\n            clearError()\r\n          },[error,message,clearError])\r\n\r\n          const changeHandler = e=>{\r\n            \r\n            setForm({...form, [e.target.name]: e.target.value})\r\n          }  \r\n\r\n          const handleImageChange= e=> {\r\n           e.preventDefault();\r\n        \r\n            const file = e.target.files[0]\r\n            setFile(file)\r\n\r\n            \r\n         \r\n          }\r\n    \r\n          const createHandler= async ()=>{\r\n            try{\r\n              const dataForm = new FormData()\r\n              dataForm.append(\"file\", file)\r\n              const data=await request('/api/galleryCategory-edit/create','POST',{...form} , \r\n              {},'application/json')\r\n              message(data.message)\r\n\r\n              const imgdata = await request('/api/galleryCategory-edit/upload-img','POST',dataForm, \r\n              {},)\r\n              message(imgdata.message)\r\n              \r\n            }catch(e){\r\n      \r\n            }\r\n        }\r\n\r\n        if (loading) {\r\n          return <Loader/>\r\n        }\r\n\r\n\r\n        \r\n    return(\r\n\r\n        <>\r\n         <div className=\"row\">\r\n            \r\n            <div className=\"adm-form col s12 m12\">\r\n           \r\n                <form onSubmit={submitHandler} method=\"post\" enctype=\"multipart/form-data\">\r\n               \r\n                        <GalleryCategoryFormFields title=\"Создание события\"\r\n                        changeHandler={changeHandler} \r\n                        state={form} \r\n                        handleImageChange={handleImageChange}\r\n                        currentRoute={currentRoute}/>\r\n                     <div className=\"row\">\r\n                    <div  className=\"input-field col s3 offset-s3  m2 offset-m4  l1 offset-l4  btn-form\">\r\n                        <button type=\"submit\" className=\"btn green waves-effect waves-light\" \r\n                        onClick={createHandler}\r\n                        disabled={loading}>Создать</button>\r\n                    </div>\r\n                    <div  className=\"input-field col s4   m1  l1  btn-form\">\r\n                        <Link style={{marginLeft:'60px'}} to=\"/admpage/galleryCategory-update\" className=\"btn blue waves-effect waves-light\">Обновить</Link>\r\n                    </div>\r\n                           \r\n                    </div>\r\n                </form>               \r\n            </div>\r\n        </div>\r\n        </>\r\n    )\r\n\r\n\r\n}\r\n\r\n export default GalleryCategoryForm;"]},"metadata":{},"sourceType":"module"}