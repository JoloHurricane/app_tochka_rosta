{"ast":null,"code":"import _createForOfIteratorHelper from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useContext,useEffect,useState}from\"react\";import DocumentFileUploadFields from'./DocumentFileUploadFields';import{NavLink,Link}from\"react-router-dom\";import{useHttp}from'../hooks/http.hook';import{Loader}from'../components/Loader';import{useMessage}from\"../hooks/message.hook\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function DocumentFileUpload(){function submitHandler(event){event.preventDefault();}var _useHttp=useHttp(),request=_useHttp.request,loading=_useHttp.loading;var message=useMessage();var _useState=useState({id:''}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),categories=_useState4[0],setCategories=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),searchTerm=_useState6[0],setSearchTerm=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),files=_useState8[0],setFiles=_useState8[1];var handleSelect=function handleSelect(e){setForm(_objectSpread(_objectSpread({},form),{},{id:e.target.value}));};var handleImageChange=function handleImageChange(e){e.preventDefault();var files=e.target.files;setFiles(files);};var handleSearch=function handleSearch(e){setSearchTerm(e.target.value);};var fetchCategories=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fetched;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return request('/api/documents-edit/documents-categories','GET',null);case 3:fetched=_context.sent;setCategories(fetched);_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[request]);useEffect(function(){fetchCategories();},[fetchCategories]);if(loading){return/*#__PURE__*/_jsx(Loader,{});}var createImg=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var dataForm,_iterator,_step,f,data,images;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dataForm=new FormData();_iterator=_createForOfIteratorHelper(files);try{for(_iterator.s();!(_step=_iterator.n()).done;){f=_step.value;dataForm.append(\"files\",f);}}catch(err){_iterator.e(err);}finally{_iterator.f();}_context2.next=6;return request(\"/api/documents-edit/add-file-create\",'POST',_objectSpread({},form),{},'application/json');case 6:data=_context2.sent;message(data.message);_context2.next=10;return request(\"/api/documents-edit/add-file\",'POST',dataForm,{});case 10:images=_context2.sent;message(images.message);_context2.next=16;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[0,14]]);}));return function createImg(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"adm-form col s12 m12\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,method:\"post\",enctype:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(DocumentFileUploadFields,{handleSearch:handleSearch,handleSelect:handleSelect,categories:categories,stateSearch:searchTerm,handleImageChange:handleImageChange,title:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0444\\u0430\\u0439\\u043B\\u043E\\u0432 \\u0434\\u043B\\u044F \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 \\u0434\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u043E\\u0432\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s3 offset-s3  m2 offset-m4  l1 offset-l4  btn-form\",children:/*#__PURE__*/_jsx(\"button\",{onClick:createImg,type:\"submit\",className:\"btn green waves-effect waves-light\",children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s4   m1  l1  btn-form\",children:/*#__PURE__*/_jsx(Link,{to:\"/admpage/galleryCategory-update\",className:\"btn blue waves-effect waves-light disabled\",children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})})]})]})})})});}export default DocumentFileUpload;","map":{"version":3,"sources":["C:/react projects/reactExpress/client/src/components/DocumentFileUpload.js"],"names":["React","useCallback","useContext","useEffect","useState","DocumentFileUploadFields","NavLink","Link","useHttp","Loader","useMessage","DocumentFileUpload","submitHandler","event","preventDefault","request","loading","message","id","form","setForm","categories","setCategories","searchTerm","setSearchTerm","files","setFiles","handleSelect","e","target","value","handleImageChange","handleSearch","fetchCategories","fetched","createImg","dataForm","FormData","f","append","data","images"],"mappings":"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","sourcesContent":["import React , {useCallback, useContext, useEffect, useState} from \"react\";\r\nimport DocumentFileUploadFields from './DocumentFileUploadFields'\r\nimport {NavLink,Link} from \"react-router-dom\";\r\nimport {useHttp} from '../hooks/http.hook'\r\nimport {Loader} from '../components/Loader'\r\nimport {useMessage} from \"../hooks/message.hook\"\r\n\r\nfunction DocumentFileUpload(){\r\n    function submitHandler(event){\r\n        event.preventDefault()\r\n    }\r\n   \r\n    const {request, loading} = useHttp()\r\n    const message = useMessage()\r\n    const [form,setForm] = useState({id:''})\r\n    const [categories, setCategories] = useState([])\r\n    const [searchTerm,setSearchTerm] = useState('')\r\n    const [files,setFiles] = useState()\r\n    \r\n\r\n    const handleSelect=(e)=>{\r\n      \r\n        setForm({...form,id:e.target.value})\r\n    }\r\n      \r\n    const handleImageChange= e=> {\r\n        e.preventDefault();\r\n     \r\n         const files = e.target.files\r\n         \r\n         setFiles(files)\r\n\r\n        \r\n         \r\n       }\r\n\r\n    const handleSearch=(e)=>{\r\n        setSearchTerm(e.target.value)\r\n       \r\n    }\r\n\r\n    const fetchCategories = useCallback(async () => {\r\n        try {\r\n            const fetched = await request('/api/documents-edit/documents-categories', 'GET', null)\r\n            setCategories(fetched)\r\n           \r\n           \r\n    } catch (e) {}\r\n  }, [request])\r\n  \r\n  useEffect(() => {\r\n    fetchCategories()\r\n    \r\n  }, [fetchCategories])\r\n\r\n  if (loading) {\r\n    return <Loader/>\r\n  }\r\n\r\n \r\n  const createImg = async()=>{\r\n    try{\r\n        const dataForm = new FormData()\r\n        for (const f of files){\r\n          dataForm.append(\"files\", f)\r\n        }\r\n        const data=await request(`/api/documents-edit/add-file-create`,'POST',{...form} , \r\n        {},'application/json')\r\n         message(data.message)\r\n        const images = await request(`/api/documents-edit/add-file`,'POST',dataForm, \r\n        {},)\r\n        message(images.message)\r\n    }catch(e){}\r\n}\r\n\r\n\r\n\r\n    return(\r\n        <>\r\n             <div className=\"row\">\r\n            \r\n            <div className=\"adm-form col s12 m12\">\r\n           \r\n                <form onSubmit={submitHandler} method=\"post\" enctype=\"multipart/form-data\">\r\n               \r\n                        <DocumentFileUploadFields \r\n                        handleSearch={handleSearch} \r\n                        handleSelect={handleSelect} \r\n                        categories={categories} \r\n                        stateSearch={searchTerm}\r\n                        handleImageChange={handleImageChange}\r\n                        title=\"Загрузка файлов для категории документов\"/>\r\n                     <div className=\"row\">\r\n                    <div  className=\"input-field col s3 offset-s3  m2 offset-m4  l1 offset-l4  btn-form\">\r\n                        <button onClick={createImg} type=\"submit\" className=\"btn green waves-effect waves-light\">Создать</button>\r\n                    </div>\r\n                    {/* <div  className=\"input-field col s3 offset-s3  m2 offset-m4  l1 offset-l4  btn-form\">\r\n                        <button onClick={check} type=\"submit\" className=\"btn waves-effect waves-light\">Check</button>\r\n                    </div> */}\r\n                    <div  className=\"input-field col s4   m1  l1  btn-form\">\r\n                        <Link to=\"/admpage/galleryCategory-update\" className=\"btn blue waves-effect waves-light disabled\">Обновить</Link>\r\n                    </div>\r\n                           \r\n                    </div>\r\n                </form>               \r\n            </div>\r\n        </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default DocumentFileUpload"]},"metadata":{},"sourceType":"module"}