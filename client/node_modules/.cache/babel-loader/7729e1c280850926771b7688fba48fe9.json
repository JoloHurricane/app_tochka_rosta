{"ast":null,"code":"import _regeneratorRuntime from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/react projects/reactExpress/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState,useCallback}from'react';import{useHttp}from\"../hooks/http.hook\";import{useMessage}from\"../hooks/message.hook\";import{Loader}from'../components/Loader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function AboutForm(){function submitHandler(event){event.preventDefault();}useEffect(function(){window.M.updateTextFields();});var _useHttp=useHttp(),loading=_useHttp.loading,error=_useHttp.error,request=_useHttp.request,clearError=_useHttp.clearError;var message=useMessage();var _useState=useState({text:''}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),disabled=_useState4[0],setDisabled=_useState4[1];// useEffect(() => {\n//     window.M.updateTextFields()\n//   },)\nuseEffect(function(){message(error);clearError();},[error,message,clearError]);var changeHandler=function changeHandler(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var fetchAbout=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fetched;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return request('/api/about-edit/about','GET',null);case 3:fetched=_context.sent;if(fetched!==null){setDisabled(true);}setForm(_objectSpread({},fetched));_context.next=10;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);})),[request]);var updateHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return request(\"/api/about-edit/update\",'POST',_objectSpread({},form),{},'application/json');case 3:data=_context2.sent;message(data.message);setForm({text:data.text});_context2.next=10;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function updateHandler(){return _ref2.apply(this,arguments);};}();var createHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return request(\"/api/about-edit/create\",'POST',_objectSpread({},form),{},'application/json');case 3:data=_context3.sent;message(data.message);setForm(_objectSpread(_objectSpread({},form),{},{_id:data.organization._id}));setDisabled(true);_context3.next=11;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,9]]);}));return function createHandler(){return _ref3.apply(this,arguments);};}();useEffect(function(){fetchAbout();},[fetchAbout]);if(loading){return/*#__PURE__*/_jsx(Loader,{});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"adm-form col s12 m12\",children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:submitHandler,method:\"post\",enctype:\"multipart/form-data\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"col s8 offset-s4\",children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438 \\u043E \\u043F\\u0440\\u043E\\u0435\\u043A\\u0442\\u0435\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"input-field col s8 offset-s2 l6 offset-l4  \",children:[/*#__PURE__*/_jsx(\"textarea\",{id:\"textarea\",name:\"text\",class:\"materialize-textarea\",value:form.text,onChange:changeHandler}),/*#__PURE__*/_jsx(\"label\",{for:\"text\",children:\"\\u0422\\u0435\\u043A\\u0441\\u0442\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s3 offset-s5  m2 offset-m5  l1 offset-l4  btn-form\",children:/*#__PURE__*/_jsx(\"button\",{disabled:loading,type:\"submit\",className:\"btn blue waves-effect waves-light\",onClick:updateHandler,children:\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-field col s3 offset-s5  m2 offset-m5  l1 offset-l4  btn-form\",children:/*#__PURE__*/_jsx(\"button\",{disabled:loading||disabled,type:\"submit\",className:\"btn green waves-effect waves-light\",onClick:createHandler,children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})})]})]})})});}export default AboutForm;","map":{"version":3,"sources":["C:/react projects/reactExpress/client/src/components/AboutForm.js"],"names":["React","useEffect","useContext","useState","useCallback","useHttp","useMessage","Loader","AboutForm","submitHandler","event","preventDefault","window","M","updateTextFields","loading","error","request","clearError","message","text","form","setForm","disabled","setDisabled","changeHandler","e","target","name","value","fetchAbout","fetched","updateHandler","data","createHandler","_id","organization"],"mappings":"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","sourcesContent":["import React,{useEffect,useContext,useState,useCallback} from 'react'\r\nimport {useHttp} from \"../hooks/http.hook\" \r\nimport {useMessage} from \"../hooks/message.hook\"\r\nimport {Loader} from '../components/Loader'\r\n\r\n\r\nfunction AboutForm(){\r\n    function submitHandler(event){\r\n        event.preventDefault()\r\n    }\r\n    useEffect(() => {\r\n        window.M.updateTextFields()\r\n      },)\r\n    const {loading,error,request,clearError} = useHttp()\r\n    const message = useMessage()\r\n    const [form,setForm] = useState({\r\n      text:'',\r\n   \r\n    })\r\n\r\n    const [disabled,setDisabled] = useState(false)\r\n    // useEffect(() => {\r\n    //     window.M.updateTextFields()\r\n    //   },)\r\n\r\n    useEffect(()=>{\r\n        message(error)\r\n        clearError()\r\n      },[error,message,clearError])\r\n\r\n   \r\n\r\n    const changeHandler = e=>{\r\n        setForm({...form, [e.target.name]: e.target.value})\r\n      }  \r\n\r\n      const fetchAbout = useCallback(async () => {\r\n        try {\r\n            const fetched = await request('/api/about-edit/about', \r\n            'GET',null,)\r\n            if (fetched!==null){\r\n              setDisabled(true)\r\n            }\r\n            setForm({...fetched})\r\n            \r\n           \r\n    } catch (e) {}\r\n  }, [request])\r\n\r\n  \r\n\r\n  const updateHandler= async ()=>{\r\n    try{\r\n     \r\n      const data=await request(`/api/about-edit/update`,'POST',{...form} , \r\n      {},'application/json')\r\n      message(data.message)\r\n      setForm({text:data.text})\r\n      \r\n    \r\n    }catch(e){\r\n\r\n    }\r\n}\r\n\r\nconst createHandler = async()=>{\r\n  try{\r\n    const data=await request(`/api/about-edit/create`,'POST',{...form} , \r\n    {},'application/json')\r\n    message(data.message)\r\n    setForm({...form,_id:data.organization._id})\r\n    setDisabled(true)\r\n   \r\n    \r\n  }catch(e){\r\n\r\n  }\r\n}\r\nuseEffect(() => {\r\n  fetchAbout()\r\n  \r\n}, [fetchAbout]) \r\n\r\nif (loading) {\r\n    return <Loader/>\r\n  }\r\n    return(\r\n        <>\r\n          <div className=\"row\">\r\n            \r\n            <div className=\"adm-form col s12 m12\">\r\n           \r\n                <form onSubmit={submitHandler} method=\"post\" enctype=\"multipart/form-data\">\r\n                    <div class=\"row\">\r\n\r\n                    <h4 className=\"col s8 offset-s4\">Изменение информации о проекте</h4>\r\n                 \r\n                    <div class=\"input-field col s8 offset-s2 l6 offset-l4  \">\r\n                    \r\n                     <textarea id=\"textarea\" name=\"text\" class=\"materialize-textarea\"\r\n                    value={form.text} onChange={changeHandler}></textarea>\r\n                     <label  for=\"text\">Текст</label>\r\n                    </div>\r\n                        </div>\r\n                </form>\r\n                        <div className=\"row\">\r\n                    <div  className=\"input-field col s3 offset-s5  m2 offset-m5  l1 offset-l4  btn-form\">\r\n                        <button disabled={loading} \r\n                        type=\"submit\" \r\n                        className=\"btn blue waves-effect waves-light\" \r\n                        onClick={updateHandler}>Обновить</button>\r\n                    </div>\r\n                    <div  className=\"input-field col s3 offset-s5  m2 offset-m5  l1 offset-l4  btn-form\">\r\n                        <button disabled={loading|| disabled} \r\n                        type=\"submit\" \r\n                        className=\"btn green waves-effect waves-light\" \r\n                        onClick={createHandler}>Создать</button>\r\n                    </div>\r\n                   \r\n                    </div>\r\n                </div>\r\n                </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default AboutForm"]},"metadata":{},"sourceType":"module"}